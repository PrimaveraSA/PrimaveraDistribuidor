<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comparador de Factura y Proforma (Excel)</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <div class="header-container">
      <h1>Comparador de Proforma de Venta</h1>
      <nav>
        <a href="Conversion.html" class="nav-btn">Ir a Conversion</a>
      </nav>
    </div>
  </header>

  <main>
    <!-- Secci√≥n de carga -->
    <section class="upload-section">
      <div class="upload-box">
        <label for="excelFile1">Factura/Boleta/Nota de Pedido (Modelo - Excel):</label>
        <input type="file" id="excelFile1" accept=".xlsx,.xls">
      </div>

      <div class="upload-box">
        <label for="excelFile2">Proforma de Venta (Maestro - Excel):</label>
        <input type="file" id="excelFile2" accept=".xlsx,.xls">
      </div>

      <div class="upload-box">
        <label for="facturaManual">N√∫mero de Numeraci√≥n:</label>
        <input type="text" id="facturaManual" placeholder="Ej: FF02-00016865">
      </div>

      <div class="upload-box">
        <label for="proformaManual">N√∫mero de Proforma Detectado:</label>
        <input type="text" id="proformaManual" placeholder="Ej: 002-00064678">
        <small style="display:block; color:#555; font-size:0.85em;">
          Se completa autom√°ticamente. Puedes corregirlo manualmente si es incorrecto.
        </small>
      </div>

      <button id="compareBtn">üîç Comparar Excel</button>
    </section>

    <!-- Resultados -->
    <section id="resultSection" class="hidden">
      <!-- üìå NUEVA SECCI√ìN: Datos del Cliente -->
      <h2>Datos del Cliente</h2>
      <div class="cliente-info">
        <div>
          <label for="clienteRazon">Raz√≥n Social</label>
          <input type="text" id="clienteRazon" placeholder="Ej: Empresa S.A.C.">
        </div>
        <div>
          <label for="clienteDNI">DNI / RUC</label>
          <input type="text" id="clienteDNI" placeholder="Ej: 20481234567">
        </div>
        <div>
          <label for="clienteDireccion">Direcci√≥n</label>
          <input type="text" id="clienteDireccion" placeholder="Ej: Jr. Lima 123">
        </div>
        <div>
          <label for="clienteReferencia">Referencia</label>
          <input type="text" id="clienteReferencia" placeholder="Ej: Frente al parque">
        </div>
        <div>
          <label for="clienteFecEmision">Fecha de Emisi√≥n</label>
          <input type="text" id="clienteFecEmision" placeholder="dd/mm/aaaa">
        </div>
        <div>
          <label for="clienteFecEntrega">Fecha de Entrega</label>
          <input type="text" id="clienteFecEntrega" placeholder="dd/mm/aaaa">
        </div>
        <div>
          <label for="clientePedido">Pedido:</label>
          <select id="clientePedido" class="form-control">
            <option value="CORRIENTE 2025" selected>CORRIENTE 2025</option>
            <option value="CAMPA√ëA 2025">CAMPA√ëA 2025</option>
            <option value="CORRIENTE 2026">CORRIENTE 2026</option>
            <option value="CAMPA√ëA 2026">CAMPA√ëA 2026</option>
          </select>
        </div>

        <div>
          <label for="tipoDocumento">Tipo de Documento</label>
          <select id="tipoDocumento" class="form-control">
            <option value="Factura Electr√≥nica" selected>Factura Electr√≥nica</option>
            <option value="Boleta Electr√≥nica">Boleta Electr√≥nica</option>
            <option value="Nota de Pedido">Nota de Pedido</option>
          </select>
        </div>
      </div>

      <h2>Productos para Saldo de Proforma</h2>
      <div class="table-container">
        <table id="resultTable" border="1" cellspacing="0" cellpadding="5">
          <thead>
            <tr>
              <th>COD</th>
              <th>DESCRIPCI√ìN</th>
              <th>UM</th>
              <th>PRECIO</th>
              <th>CANT</th>
              <th>SUB TOTAL</th>
              <th>ACCIONES</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="action-buttons hidden">
        <button id="downloadBtn">Descargar PDF</button>
        <button id="backBtn">Nueva Comparaci√≥n</button>
      </div>
    </section>
  </main>

  <footer>
    <p>¬© 2025 Primavera Distribuidores S.A.C. Todos los derechos reservados</p>
  </footer>

  <!-- üìö Librer√≠as necesarias -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jszip/dist/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  <script type="module" src="scripts.js"></script>

  <!-- Modal de conexi√≥n -->
  <div id="conexionModal">
    <div class="modal-content">
      <h3 id="modalTitulo">‚ö† Conexi√≥n Fallida</h3>
      <p id="modalMensaje">Tu conexi√≥n a internet se ha perdido.</p>
      <button id="recargarBtn">Recargar</button>
    </div>
  </div>

  <!-- Toasts -->
  <div id="toastConexion" style="display:none; position:fixed; bottom:20px; right:20px; 
      background:#4caf50; color:#fff; padding:12px 20px; border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,0.3); z-index:9999;">
    ‚úÖ Conexi√≥n restablecida
  </div>

  <div id="toastDuplicado" style="display:none; position:fixed; bottom:20px; right:20px; 
      background:#e7e40b; color:#000000; padding:12px 20px; border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,0.3); z-index:9999;">
    ‚ö†Ô∏è Se detectaron c√≥digos repetidos en el archivo. Por favor, rev√≠salo.
  </div>

</body>
</html>
